@model IEnumerable<EnglishLearning.Models.TranslationHistory>
@{
    ViewData["Title"] = "Chi tiết lịch sử dịch";
    Layout = "~/Views/Shared/TopFoot.cshtml";
}

<div class="container mt-5 mb-5">
    <div class="card shadow-lg border-0 animate__animated animate__fadeIn">
        <div class="card-header bg-gradient-primary text-white d-flex justify-content-between align-items-center">
            <h2 class="mb-0"><i class="bi bi-clock-history me-2"></i>Chi tiết lịch sử dịch</h2>
            <div>
                <a asp-action="History" asp-controller="Translation" class="btn btn-light btn-sm rounded-pill"><i class="bi bi-arrow-left me-2"></i>Quay lại</a>
            </div>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover table-striped align-middle">
                    <thead class="bg-dark text-white">
                        <tr>
                            <th scope="col">Câu</th> <!-- Thêm cột chỉ số câu -->
                            <th scope="col">Thời gian</th>
                            <th scope="col">Chủ đề</th>
                            <th scope="col">Câu gốc</th>
                            <th scope="col">Bản dịch của bạn</th>
                            <th scope="col">Bản dịch chuẩn</th>
                            <th scope="col">Độ chính xác</th>
                            <th scope="col">Gợi ý lỗi</th>
                        </tr>
                    </thead>
                    <tbody>
                        @* Sắp xếp theo ParagraphId và Timestamp để giữ thứ tự câu trong mỗi đoạn văn *@
                        @foreach (var item in Model.OrderBy(x => x.Timestamp))
                        {
                            <tr class="animate__animated animate__fadeInUp">
                                <td>
                                    @* Tính chỉ số câu dựa trên thứ tự trong ParagraphId, giả sử mỗi ParagraphId đại diện một đoạn văn *@
                                    @((Model.Where(x => x.ParagraphId == item.ParagraphId).OrderBy(x => x.Timestamp).ToList().IndexOf(item) + 1).ToString())
                                </td>
                                <td>@item.Timestamp.ToLocalTime().ToString("dd/MM/yyyy HH:mm")</td>
                                <td><span class="badge bg-gradient-info text-dark">@item.Topic</span></td>
                                <td>@item.OriginalSentence</td>
                                <td>@item.UserTranslation</td>
                                <td>@item.StandardTranslation</td>
                                <td>
                                    <div class="progress" style="height: 25px;">
                                        <div class="progress-bar bg-gradient-success animate__animated animate__slideInLeft" role="progressbar" style="width: @item.Accuracy%;
                                        color: black;
                                        font-size: 1rem;
                                        line-height: 35px;
                                        padding: 0 10px;
                                        transition: width 0.6s ease;
                                            " aria-valuenow="@item.Accuracy" aria-valuemin="0" aria-valuemax="100">
                                            @item.Accuracy%
                                        </div>
                                    </div>
                                </td>
                                <td>@item.ErrorSuggestion</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>



<link href="~/css/historytranslation.css" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">